#include <stdio.h>
#include <string.h>

#define N 5   // 상품 개수 (추후 확장 가능)
#define LEN 30 // 상품명 최대 길이

int main() {
    int 입고[N] = {0};   // 입고 수량
    int 판매[N] = {0};   // 판매 수량
    int 재고[N] = {0};   // 재고 수량
    char 상품명[N][LEN]; // 상품명 저장용 2차원 배열

    // 초기 상품명은 "상품1", "상품2" ...
    for (int i = 0; i < N; i++) {
        sprintf(상품명[i], "상품%d", i + 1);
    }

    // 포인터 설정
    int *p입고 = 입고;
    int *p판매 = 판매;
    int *p재고 = 재고;

    int menu;
    while (1) {
        printf("\n[쇼핑몰 재고 관리 프로그램]\n");
        printf("원하는 메뉴를 선택하세요. (1. 입고, 2. 판매, 3. 상품현황, 4. 상품명 입력, 5. 종료)\n> ");
        scanf("%d", &menu);

        if (menu == 1) {  // 입고
            int type;
            printf("입고수량 입력: 전체상품(1), 개별상품(2) 선택: ");
            scanf("%d", &type);

            if (type == 1) {
                printf("전체 상품 입고수량 입력 (%d개): ", N);
                for (int i = 0; i < N; i++) {
                    scanf("%d", (p입고 + i));
                    *(p재고 + i) += *(p입고 + i);
                }
            } else if (type == 2) {
                int id, qty;
                printf("상품 ID 입력 (1~%d): ", N);
                scanf("%d", &id);
                printf("입고 수량 입력: ");
                scanf("%d", &qty);
                *(p입고 + id - 1) += qty;
                *(p재고 + id - 1) += qty;
            }

        } else if (menu == 2) {  // 판매
            int type;
            printf("판매수량 입력: 전체상품(1), 개별상품(2) 선택: ");
            scanf("%d", &type);

            if (type == 1) {
                printf("전체 상품 판매수량 입력 (%d개): ", N);
                for (int i = 0; i < N; i++) {
                    int qty;
                    scanf("%d", &qty);
                    if (qty <= *(p재고 + i)) {
                        *(p판매 + i) += qty;
                        *(p재고 + i) -= qty;
                    } else {
                        printf("❌ %s 재고 부족 (재고 %d)\n", 상품명[i], *(p재고 + i));
                    }
                }
            } else if (type == 2) {
                int id, qty;
                printf("상품 ID 입력 (1~%d): ", N);
                scanf("%d", &id);
                printf("판매 수량 입력: ");
                scanf("%d", &qty);
                if (qty <= *(p재고 + id - 1)) {
                    *(p판매 + id - 1) += qty;
                    *(p재고 + id - 1) -= qty;
                } else {
                    printf("❌ %s 재고 부족! 현재 재고: %d\n", 상품명[id - 1], *(p재고 + id - 1));
                }
            }

        } else if (menu == 3) {  // 상품현황
            printf("\n[상품 현황]\n");

            // 재고 출력
            printf("재고수량: ");
            for (int i = 0; i < N; i++) {
                printf("%d ", *(p재고 + i));
            }
            printf("\n");

            // 총 판매량, 판매율
            int 총판매 = 0, 총입고 = 0;
            for (int i = 0; i < N; i++) {
                총판매 += *(p판매 + i);
                총입고 += *(p판매 + i) + *(p재고 + i);
            }
            double 판매율 = (총입고 > 0) ? (double)총판매 / 총입고 * 100 : 0.0;
            printf("총 판매량: %d (판매율 %.2f%%)\n", 총판매, 판매율);

            // 최대/최소 판매량 찾기
            int max판매 = *p판매, min판매 = *p판매;
            for (int i = 1; i < N; i++) {
                if (*(p판매 + i) > max판매) max판매 = *(p판매 + i);
                if (*(p판매 + i) < min판매) min판매 = *(p판매 + i);
            }

            // 가장 많이 판매된 상품
            printf("가장 많이 판매된 상품: ");
            for (int i = 0; i < N; i++) {
                if (*(p판매 + i) == max판매)
                    printf("ID %d (%s), 판매량 %d ", i + 1, 상품명[i], *(p판매 + i));
            }
            printf("\n");

            // 가장 적게 판매된 상품
            printf("가장 적게 판매된 상품: ");
            for (int i = 0; i < N; i++) {
                if (*(p판매 + i) == min판매)
                    printf("ID %d (%s), 판매량 %d ", i + 1, 상품명[i], *(p판매 + i));
            }
            printf("\n");

            // 재고 부족 경고
            for (int i = 0; i < N; i++) {
                if (*(p재고 + i) <= 2) {
                    printf("%s : 재고부족(%d)\n", 상품명[i], *(p재고 + i));
                }
            }

        } else if (menu == 4) {  // 상품명 입력
            printf("\n[상품명 입력]\n");
            for (int i = 0; i < N; i++) {
                printf("ID %d 상품명: ", i + 1);
                scanf("%s", 상품명[i]);
            }

        } else if (menu == 5) {  // 종료
            printf("프로그램을 종료합니다.\n");
            break;
        } else {
            printf("❌ 잘못된 선택입니다. 다시 입력하세요.\n");
        }
    }

    return 0;
}
